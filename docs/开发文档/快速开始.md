# å¿«é€Ÿå¼€å§‹æŒ‡å—

æœ¬æ–‡æ¡£è¯¦ç»†ä»‹ç»å¦‚ä½•åœ¨æœ¬åœ°æ­å»ºå’Œè¿è¡Œ 1611 å€¼æ—¥ç³»ç»Ÿã€‚

---

## ğŸ“‹ å‰ç½®è¦æ±‚

### æ–¹å¼ä¸€ï¼šDocker éƒ¨ç½²
- Docker Desktop å·²å®‰è£…å¹¶è¿è¡Œ
- Git

### æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘
- Node.js 20+
- pnpm (æ¨è) æˆ– npm
- PostgreSQL æ•°æ®åº“
- Git

---

## ğŸš€ æ–¹å¼ä¸€ï¼šDocker ä¸€é”®å¯åŠ¨ï¼ˆæ¨èï¼‰

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/Yangtian-yu/1611sys.git
cd 1611sys
```

### 2. é…ç½®ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶ï¼š

```bash
cp .env.example .env
```

ç¼–è¾‘ `.env` æ–‡ä»¶ï¼Œé…ç½®å¿…è¦ä¿¡æ¯ï¼š

```env
# æ•°æ®åº“é…ç½®
POSTGRES_USER=postgres
POSTGRES_PASSWORD=your_password
POSTGRES_DB=duty_system
DATABASE_URL=postgresql://postgres:your_password@postgres:5432/duty_system

# JWT é…ç½®
JWT_SECRET=your-secret-key-change-in-production

# é‚®ä»¶é…ç½®
MAIL_USER=your-email@example.com
MAIL_PASS=your-email-password

# å…¶ä»–é…ç½®
NODE_ENV=production
PORT=3000
```

### 3. å¯åŠ¨æœåŠ¡

```bash
# Windows ç”¨æˆ·
start.bat

# Linux/Mac ç”¨æˆ·
chmod +x start.sh
./start.sh
```

æˆ–æ‰‹åŠ¨å¯åŠ¨ï¼š

```bash
docker compose up -d
```

### 4. è®¿é—®åº”ç”¨

- **å‰ç«¯**ï¼šhttp://localhost
- **åç«¯ API**ï¼šhttp://localhost:3000/api
- **å¥åº·æ£€æŸ¥**ï¼šhttp://localhost:3000/api/health

### 5. æŸ¥çœ‹æ—¥å¿—

```bash
# æŸ¥çœ‹æ‰€æœ‰æœåŠ¡æ—¥å¿—
docker compose logs -f

# æŸ¥çœ‹åç«¯æ—¥å¿—
docker compose logs -f backend

# æŸ¥çœ‹å‰ç«¯æ—¥å¿—
docker compose logs -f frontend

# æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
docker compose logs -f postgres
```

### Docker å¸¸ç”¨å‘½ä»¤

```bash
# åœæ­¢æœåŠ¡
docker compose down

# é‡å¯æœåŠ¡
docker compose restart

# é‡æ–°æ„å»ºå¹¶å¯åŠ¨
docker compose up -d --build

# æŸ¥çœ‹å®¹å™¨çŠ¶æ€
docker compose ps

# è¿›å…¥å®¹å™¨
docker compose exec backend sh
docker compose exec postgres psql -U postgres -d duty_system
```

---

## ğŸ’» æ–¹å¼äºŒï¼šæœ¬åœ°å¼€å‘æ¨¡å¼

### 1. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/Yangtian-yu/1611sys.git
cd 1611sys
```

### 2. å®‰è£…ä¾èµ–

```bash
# å®‰è£…åç«¯ä¾èµ–
cd backend
pnpm install

# å®‰è£…å‰ç«¯ä¾èµ–
cd ../frontend
pnpm install
```

### 3. é…ç½®æ•°æ®åº“

ç¡®ä¿ PostgreSQL æœåŠ¡å·²å¯åŠ¨ï¼Œåˆ›å»ºæ•°æ®åº“ï¼š

```sql
CREATE DATABASE duty_system;
```

ç¼–è¾‘ `backend/.env` æ–‡ä»¶ï¼š

```env
DATABASE_URL="postgresql://ç”¨æˆ·å:å¯†ç @localhost:5432/duty_system"
JWT_SECRET="your-secret-key-change-in-production-1611"
PORT=3000
NODE_ENV=development

# é‚®ä»¶é…ç½®ï¼ˆå¯é€‰ï¼‰
MAIL_USER=your-email@example.com
MAIL_PASS=your-email-password
```

### 4. åˆå§‹åŒ–æ•°æ®åº“

```bash
cd backend

# ç”Ÿæˆ Prisma Client
pnpm prisma:generate

# è¿è¡Œæ•°æ®åº“è¿ç§»
pnpm prisma:migrate

# åˆå§‹åŒ–ç§å­æ•°æ®ï¼ˆåˆ›å»ºç®¡ç†å‘˜å’Œæµ‹è¯•è´¦å·ï¼‰
pnpm prisma:seed
```

### 5. å¯åŠ¨å¼€å‘æœåŠ¡å™¨

**åç«¯**ï¼ˆåœ¨ backend ç›®å½•ï¼‰ï¼š

```bash
pnpm start:dev
```

åç«¯æœåŠ¡å°†è¿è¡Œåœ¨ http://localhost:3000

**å‰ç«¯**ï¼ˆåœ¨ frontend ç›®å½•ï¼Œæ–°å¼€ä¸€ä¸ªç»ˆç«¯ï¼‰ï¼š

```bash
cd ../frontend
pnpm dev
```

å‰ç«¯æœåŠ¡å°†è¿è¡Œåœ¨ http://localhost:5173

### 6. è®¿é—®åº”ç”¨

- **å‰ç«¯**ï¼šhttp://localhost:5173
- **åç«¯ API**ï¼šhttp://localhost:3000/api

---

## ğŸ”‘ æµ‹è¯•è´¦å·

ç³»ç»Ÿåˆå§‹åŒ–åä¼šè‡ªåŠ¨åˆ›å»ºæµ‹è¯•è´¦å·ï¼š

### ç®¡ç†å‘˜è´¦å·
- **ç”¨æˆ·å**ï¼š`admin`
- **å¯†ç **ï¼š`Admin@1611`
- **æƒé™**ï¼šæ‰€æœ‰åŠŸèƒ½

### æ™®é€šå‘˜å·¥è´¦å·
- **ç”¨æˆ·å**ï¼š`ææ˜` / `ç‹èŠ³` / `å¼ ä¸‰` / `æå››`
- **å¯†ç **ï¼š`123456`
- **æƒé™**ï¼šæŸ¥çœ‹å€¼æ—¥å®‰æ’

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
1611sys/
â”œâ”€â”€ backend/                # åç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ modules/
â”‚   â”‚   â”‚   â”œâ”€â”€ auth/      # è®¤è¯æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ duty/      # å€¼æ—¥æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ user/      # ç”¨æˆ·æ¨¡å—
â”‚   â”‚   â”‚   â”œâ”€â”€ mail/      # é‚®ä»¶æ¨¡å—
â”‚   â”‚   â”‚   â””â”€â”€ health/    # å¥åº·æ£€æŸ¥æ¨¡å—
â”‚   â”‚   â”œâ”€â”€ prisma/        # Prisma æœåŠ¡
â”‚   â”‚   â”œâ”€â”€ app.module.ts
â”‚   â”‚   â””â”€â”€ main.ts
â”‚   â”œâ”€â”€ prisma/
â”‚   â”‚   â”œâ”€â”€ schema.prisma  # æ•°æ®åº“ Schema
â”‚   â”‚   â””â”€â”€ seed.ts        # ç§å­æ•°æ®
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ frontend/               # å‰ç«¯é¡¹ç›®
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ views/         # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ stores/        # Pinia stores
â”‚   â”‚   â”œâ”€â”€ router/        # è·¯ç”±é…ç½®
â”‚   â”‚   â”œâ”€â”€ api/           # API æ¥å£
â”‚   â”‚   â”œâ”€â”€ types/         # TypeScript ç±»å‹
â”‚   â”‚   â”œâ”€â”€ App.vue
â”‚   â”‚   â””â”€â”€ main.ts
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â””â”€â”€ package.json
â”‚
â”œâ”€â”€ docs/                   # æ–‡æ¡£
â”œâ”€â”€ scripts/                # è¿ç»´è„šæœ¬
â”œâ”€â”€ .github/workflows/      # CI/CD é…ç½®
â”œâ”€â”€ docker-compose.yml
â””â”€â”€ README.md
```

---

## â“ å¸¸è§é—®é¢˜

### 1. æ•°æ®åº“è¿æ¥å¤±è´¥ï¼Ÿ

**ç—‡çŠ¶**ï¼šåç«¯å¯åŠ¨æŠ¥é”™ `Can't reach database server`

**è§£å†³**ï¼š
- æ£€æŸ¥ PostgreSQL æœåŠ¡æ˜¯å¦å¯åŠ¨
- ç¡®è®¤ `backend/.env` ä¸­çš„ `DATABASE_URL` é…ç½®æ­£ç¡®
- ç¡®è®¤æ•°æ®åº“å·²åˆ›å»ºï¼š`CREATE DATABASE duty_system;`

### 2. å‰ç«¯æ— æ³•è®¿é—®åç«¯ APIï¼Ÿ

**ç—‡çŠ¶**ï¼šå‰ç«¯è¯·æ±‚æŠ¥ `Network Error` æˆ– `404`

**è§£å†³**ï¼š
- ç¡®ä¿åç«¯æœåŠ¡å·²å¯åŠ¨ï¼ˆhttp://localhost:3000ï¼‰
- æ£€æŸ¥ `frontend/.env` ä¸­çš„ `VITE_API_BASE_URL` é…ç½®
- æ£€æŸ¥åç«¯ CORS é…ç½®

### 3. ç™»å½•åæç¤º 401 é”™è¯¯ï¼Ÿ

**ç—‡çŠ¶**ï¼šç™»å½•æˆåŠŸä½†åç»­è¯·æ±‚è¿”å› 401

**è§£å†³**ï¼š
- æ£€æŸ¥ JWT token æ˜¯å¦è¿‡æœŸ
- æ¸…é™¤æµè§ˆå™¨ç¼“å­˜å’Œ LocalStorage
- é‡æ–°ç™»å½•

### 4. Docker æ„å»ºå¤±è´¥ï¼Ÿ

**ç—‡çŠ¶**ï¼š`docker compose build` æŠ¥é”™

**è§£å†³**ï¼š
- ç¡®ä¿ Docker Desktop æ­£åœ¨è¿è¡Œ
- æ¸…ç† Docker ç¼“å­˜ï¼š`docker system prune -a`
- é‡æ–°æ„å»ºï¼š`docker compose build --no-cache`

### 5. é‚®ä»¶å‘é€å¤±è´¥ï¼Ÿ

**ç—‡çŠ¶**ï¼šé‚®ä»¶é€šçŸ¥æœªå‘é€

**è§£å†³**ï¼š
- ç¡®è®¤ `.env` ä¸­çš„é‚®ä»¶é…ç½®æ­£ç¡®
- ç¡®è®¤é‚®ç®±å·²å¼€å¯ SMTP æœåŠ¡
- æŸ¥çœ‹åç«¯æ—¥å¿—ï¼š`docker compose logs backend | grep mail`

---

## ğŸ”§ å¼€å‘å·¥å…·æ¨è

- **IDE**ï¼šVSCode + Vue/TypeScript æ’ä»¶
- **æ•°æ®åº“ç®¡ç†**ï¼šDBeaver / Prisma Studio (`pnpm prisma studio`)
- **API æµ‹è¯•**ï¼šPostman / Thunder Client
- **Git å®¢æˆ·ç«¯**ï¼šSourceTree / GitKraken

---

## ğŸ“š ä¸‹ä¸€æ­¥

- [API æ–‡æ¡£](./APIæ–‡æ¡£.md) - äº†è§£æ¥å£ä½¿ç”¨
- [äº§å“è§„æ ¼](./äº§å“è§„æ ¼.md) - äº†è§£ä¸šåŠ¡é€»è¾‘
- [è´¡çŒ®æŒ‡å—](./è´¡çŒ®æŒ‡å—.md) - å‚ä¸é¡¹ç›®å¼€å‘
